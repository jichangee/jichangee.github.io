<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>古道长亭 - 免费领取外卖红包</title>
    <link
      rel="stylesheet"
      href="https://www.layuicdn.com/layui-v2.5.6/css/layui.css"
    />
    <style>
      body{background-color:#f5f5f5;padding:12px;color:#333}p{margin:0}body>div{margin-bottom:10px}.layui-form{padding:12px 18px 12px 0}.layui-form-label{padding-left:0}.layui-input-block{margin-left:95px}.block{background-color:#fff;box-shadow:0 1px 2px 0 rgba(0,0,0,0.05);margin-bottom:12px}.goods-detail .head{display:flex;align-items:center;justify-content:space-between;padding:8px 18px}.l{display:flex;align-items:center}.r span{background-color:#ff5722;font-size:12px;color:#fff;border-radius:2px;padding:2px 4px}#price{font-size:20px;margin-right:2px;color:#1e9fff}#originPrice{text-decoration:line-through;color:#999;font-size:12px}.footer-plac{height:54px}.footer{position:fixed;bottom:0;left:0;width:100%;padding:8px 18px;box-sizing:border-box;margin:0}.services{padding:8px 18px;font-size:12px;color:#666}.services h4{font-weight:500;margin-bottom:5px}.coupon-link{display:none;align-items:center;justify-content:space-between;margin:12px 0;padding:8px}span[id="cnzz_stat_icon_1279304047"]{display:none}
    </style>
  </head>
  <body>
    <div class="main">
      <div class="goods-detail block">
        <div class="head">
          <div class="l">
            <i class="layui-icon layui-icon-light"></i> 古道长亭
          </div>
          <div class="r">
            <span>自动发货</span>
          </div>
        </div>
      </div>
      <div class="coupon-link block"></div>
      <div class="layui-form block" lay-filter="submitForm">
        <div class="layui-form-item">
          <label class="layui-form-label">选择商品</label>
          <div class="layui-input-block">
            <select
              id="tid"
              lay-verify="required"
              lay-filter="tid"
              name="tid"
            ></select>
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">商品简介</label>
          <div class="layui-input-block">
            <div class="layui-form-mid" id="desc"></div>
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">价格</label>
          <div class="layui-input-block">
            <div class="layui-form-mid">
              <span id="price"></span>元
              <span id="originPrice"></span>
            </div>
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">手机号</label>
          <div class="layui-input-block">
            <input
              type="number"
              name="phone"
              required
              id="phone"
              lay-verify="phone"
              placeholder="请输入手机号"
              autocomplete="off"
              class="layui-input"
            />
          </div>
        </div>
        <div class="layui-form-item">
          <label class="layui-form-label">支付类型</label>
          <div class="layui-input-block">
            <input
              type="radio"
              name="payType"
              value="1"
              title="支付宝"
              checked
              id="alipay"
            />
            <input
              type="radio"
              name="payType"
              value="3"
              title="微信支付"
              id="wechatpay"
            />
          </div>
        </div>
        <div class="layui-form-item footer block">
          <button
            class="layui-btn layui-btn-normal"
            style="width: 100%"
            lay-submit
            lay-filter="formSubmit"
          >
            购买
          </button>
        </div>
      </div>
      <div class="block services">
        <h4>注意事项</h4>
        <p>正常情况下付款后30秒内到账，超过5分钟未到账请联系客服</p>
        <p>客服QQ: 1970220264</p>
      </div>
      <div class="footer-plac"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
    <script src="https://www.layuicdn.com/layui-v2.5.6/layui.js"></script>
    <script>
      "use strict";function getGoodsList(t){$.ajax({url:BASE_URL+"/api/goods/list",method:"get",success:function(e){0===e.code&&t&&t(e.data)}})}function getGoodsItem(t){for(var e=0;e<goodsList.length;e++){var n=goodsList[e];if(n.tid===Number(t))return n}return null}function setGoodsItem(t){var e=getGoodsItem(t);$("#price").html(e.price),e.originPrice&&e.originPrice!==e.price?$("#originPrice").html(e.originPrice+"元"):$("#originPrice").html(""),$("#desc").html(e.description)}function getDocumentTitle(){$.get(BASE_URL+"/api/title",function(t){document.title=t.data.title})}function openLink(t,e){_czc.push(["_trackEvent","点击免费领取外卖",e]),window.location.href=t}function getCouponLink(){$.get(BASE_URL+"/api/coupon/link",function(t){var e=t.data;if(e.length>0){for(var n=0;n<e.length;n++){var i=e[n];$(".coupon-link").append("<a href=\"javascript:openLink('".concat(i.link,"', '").concat(i.title,'\');" class="layui-btn layui-btn-').concat(i.style,'">').concat(i.title,"</a>"))}$(".coupon-link").css("display","flex")}})}function buy(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=getUUID();$.ajax({url:BASE_URL+"/api/buy?phone="+t+"&tid="+e+"&type="+n+"&uuid="+i+"&returnUrl="+encodeURIComponent(window.location.origin+"/member/success.html"),method:"get",success:function(t){0===t.code&&(window.location.href=t.data)},fail:function(){loading=!1}})}function bin2hex(t){var e,n,i,o="";for(t+="",e=0,n=t.length;e<n;e++)i=t.charCodeAt(e).toString(16),o+=i.length<2?"0"+i:i;return o}function renderOption(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments[1];getGoodsList(function(n){goodsList=n.slice();for(var i=0;i<n.length;i++){var o=n[i];(t||3!==o.tid)&&$("#tid").append($('<option value="'+o.tid+'">'+o.title+"</option>"))}e&&e()})}function getUUID(){var t=localStorage.getItem("uuid");if(t)return t;try{var e=document.createElement("canvas"),n=e.getContext("2d"),i=window.location.href;n.textBaseline="top",n.font="14px 'Arial'",n.textBaseline="tencent",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText(i,2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText(i,4,17);var o=e.toDataURL().replace("data:image/png;base64,",""),a=atob(o);t=bin2hex(a.slice(-16,-12))}catch(e){t=Date.now()+parseInt(1e5*Math.random())}return localStorage.setItem("uuid",t),t}function togglePayType(){var t=checkUserAgent();t.wechat?($("#alipay").remove(),$("#wechatpay").attr("checked",!0)):t.alipay&&$("#wechatpay").remove()}function checkUserAgent(){var t=navigator.userAgent;return{wechat:!!t.match(/MicroMessenger/i),alipay:!!t.match(/Alipay/i)}}var BASE_URL="http://212.64.39.225:9090",goodsList=[],loading=!1,dev=window.location.search.indexOf("dev=true")>-1;togglePayType(),layui.use(["layer","form"],function(t,e){getCouponLink(),renderOption(dev,function(){setGoodsItem(e.val("submitForm").tid)}),e.on("select(tid)",function(t){setGoodsItem(t.value)}),e.on("submit(formSubmit)",function(e){var n=e.field;loading||(_czc.push(["_trackEvent","购买","提交表单",n.tid]),t.confirm("确认为【"+n.phone+"】购买？",{btn:["确认","取消"]},function(){this.loading=!0,buy(n.phone,n.tid,n.payType),_czc.push(["_trackEvent","购买","支付",n.tid])}))}),getDocumentTitle()});
    </script>
    <script>
      "use strict";!function(){var t=document.createElement("script");t.type="text/javascript",t.charset="utf-8",t.async=!0;var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e),t.src="https://w.cnzz.com/c.php?id=1279304047&async=1"}();
    </script>
  </body>
</html>
